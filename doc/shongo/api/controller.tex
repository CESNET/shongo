\chapter{Controller API}
\label{chapter:controller-api}

\input{commands}

\section{Communication Protocol}
Controller API is provided through XML-RPC \cite{xml-rpc}.
In XML-RPC all described types are represented as follows:

\begin{itemize}

\item Values of atomic types are represented by their's equivalent in XML-RPC (e.g., integer value \ApiValue{42} as \ApiValue{<i4>42</i4>} or string value \ApiValue{Hello} as \ApiValue{<string>Hello</string>}).

\item Enum values are represented as strings (e.g., \ApiValue{Technology.H323} as \ApiValue{<string>H323</string>}).

\item Arrays and collections are represented as XML-RPC arrays, e.g.
\begin{verbatim}
[101, 202]
\end{verbatim}
as
\begin{verbatim}
<array>
  <data>
    <value><i4>101</i4></value>
    <value><i4>202</i4></value>
  </data>
</array>
\end{verbatim}

\item Object instances are represented as XML-RPC struct types with special \ApiValue{class} attribute specifying object type, e.g.
\begin{verbatim}
Person {
  name: "Martin Srom",
  email: "srom@cesnet.cz"
}
\end{verbatim}
as
\begin{verbatim}
<struct>
  <member>
    <name>class</name>
    <value><string>Person</string></value>
  </member>
  <member>
    <name>name</name>
    <value><string>Martin Srom</string></value>
  </member>
  <member>
    <name>email</name>
    <value><string>srom@cesnet.cz</string></value>
  </member>
</struct>
\end{verbatim}

\item Null values are represented as empty XML-RPC struct type (<struct></struct>). It is useful e.g., when the user want to clear attribute value by any modify API method. He should set the attribute value to empty struct and the value will be cleared on the server.

\item Failures are propagated through XML-RPC by \ApiCode{faultCode} and \ApiCode{faultString} values.

\end{itemize}


\section{Data types}

This section contains description of types used only in Controller API.

\begin{Api}

%\ApiEnum{ControllerType}
%Types of controllers in the domain.
%\begin{ApiEnumValues}
%\ApiEnumValue{Primary}{} The primary controller.
%\ApiEnumValue{Backup}{} A backup controller. Behaves just like the primary controller, even some agents may be connected to a backup controller instead of the primary one.
%\end{ApiEnumValues}

\ApiClass{Controller}{}
Descriptor of a \gls{g:controller}.
\begin{ApiClassAttributes}
\ApiClassAttribute{domain}{Domain}{\ApiReadOnly} \Gls{g:domain} which is controlled by the controller.
\end{ApiClassAttributes}

\ApiClass{Domain}{}
Descriptor of a \gls{g:domain}.
\begin{ApiClassAttributes}
\ApiClassAttribute{name}{String}{\ApiRequired} A unique domain name (e.g., \ApiValue{cz.cesnet}).
\ApiClassAttribute{organization}{String}{\ApiOptional} Name of organization owning the domain (e.g., \ApiValue{CESNET, z.s.p.o.}).
\ApiClassAttribute{status}{Status}{\ApiReadOnly} Status whether the domain controller is available.
\end{ApiClassAttributes}

\ApiClass{Connector}{}
Descriptor of a \gls{g:connector-agent} which is managing a \gls{g:resource-device}.
\begin{ApiClassAttributes}
\ApiClassAttribute{name}{String}{\ApiReadOnly} Unique name of the \gls{g:connector-agent} within the \gls{g:domain} (name of JADE agent).
\ApiClassAttribute{resourceId}{String}{\ApiReadOnly} Identifier of a \gls{g:resource-device} which is managed by the \gls{g:connector-agent}.
\ApiClassAttribute{status}{Status}{\ApiReadOnly} Status whether the \gls{g:connector-agent} is available to the \gls{g:controller}.
\end{ApiClassAttributes}

\ApiEnum{Status}
Status of a \ApiRef{Domain} or \ApiRef{Connector}.
\begin{ApiEnumValues}
\ApiEnumValue{AVAILABLE}{} Means that a \ApiRef{Domain} or \ApiRef{Connector} is available to the \gls{g:controller}.
\ApiEnumValue{NOT_AVAILABLE}{} Means that a \ApiRef{Domain} or \ApiRef{Connector} is not currently available to the \gls{g:controller}.
\end{ApiEnumValues}

\ApiClass{DateTimeSlot}{}
Date/time slot can represent one or more \ApiRef{Interval} values. Definition of date/time slot is a pair of starting date/time and duration, where starting date/time can be periodic and thus can result into multiple absolute date/times.
\begin{ApiClassAttributes}
\ApiClassAttribute{id}{String}{\ApiReadOnly} Identifier of the date/time slot.
\ApiClassAttribute{start}{DateTime,PeriodicDateTime}{\ApiRequired}
Defines the start of date/time slot (or multiple starts in case of periodic date/time).
\ApiClassAttribute{duration}{Period}{\ApiRequired}
Defines the duration of date/time slot.
\end{ApiClassAttributes}

For reservation purposes, the collection of \ApiRef{DateTimeSlot}s should be used to provide the ability to reserve multiple date/times with different periods (e.g., on every Monday from 14:00 to 15:00 and every Thursday from 16:00 to 18:00).

If date/time slot contains \ApiRef{PeriodicDateTime}, all periodic events can be listed by evaluating date/time slot to colllection of \ApiRef{Interval}s.

\ApiClass{Alias}{}
Represents an \gls{g:device-alias} for a \gls{g:device}.
\begin{ApiClassAttributes}
\ApiClassAttribute{id}{String}{\ApiReadOnly} Identifier of the \gls{g:device-alias}.
\ApiClassAttribute{type}{AliasType}{\ApiRequired} Type of the \gls{g:device-alias} (e.g., \ApiValue{H323\_E164}).
\ApiClassAttribute{value}{String}{\ApiRequired} Value of the \gls{g:device-alias} (e.g., \ApiValue{950087704}).
\end{ApiClassAttributes}

\ApiEnum{AliasType}
Enumeration of available types of \glspl{g:device-alias}.
\begin{ApiEnumValues}
\ApiEnumValue{ROOM_NAME}{} Name for a \gls{g:device-virtual-room}.
\ApiEnumValue{H323_E164}{} See \url{http://en.wikipedia.org/wiki/E.164}.
\ApiEnumValue{H323_URI}{} H.323 url.
\ApiEnumValue{SIP_URI}{} e.g., sip:srom@cesnet.cz.
\ApiEnumValue{ADOBE_CONNECT_URI}{} Adobe Connect room url.
\end{ApiEnumValues}

\ApiEnum{CallInitiation}
Enumeration of preference who should initiate a \gls{g:device-connection}.
\begin{ApiEnumValues}
\ApiEnumValue{TERMINAL}{} A terminal should initiate the \gls{g:device-connection} to a \gls{g:device-virtual-room} (it is referred to as \emph{call in}).
\ApiEnumValue{VIRTUAL_ROOM}{} A \gls{g:device-virtual-room} should initiate the \gls{g:device-connection} to a terminal (it is referred to as \emph{call out}).
\end{ApiEnumValues}

\ApiClass{Resource}{}
This class represents a complete \gls{g:resource} definition. This class is used for creating and modifying \glspl{g:resource}.
\begin{ApiClassAttributes}
\ApiClassAttribute{id}{String}{\ApiReadOnly} \Gls{g:resource} unique identifier as defined in \UCref{res:identification}.
\ApiClassAttribute{userId}{String}{\ApiReadOnly} Identifier of the owner user who created the \gls{g:resource} in the \gls{g:controller}.
\ApiClassAttribute{parentResourceId}{String}{\ApiOptional} A parent \gls{g:resource} identifier in which is the \gls{g:resource} located (e.g., identifier of a physical room).
\ApiClassAttribute{name}{String}{\ApiRequired} Short name which describes the \gls{g:resource}.
\ApiClassAttributeCollection{capabilities}{List}{Capability}{\ApiOptional} List of capabilities which the \gls{g:resource} has.
\ApiClassAttribute{description}{String}{\ApiOptional} Long description depicting the \gls{g:resource}.
\ApiClassAttribute{allocatable}{boolean}{\ApiOptionalDefault{false}} Specifies whether the \gls{g:resource} can be allocated to a \gls{g:reservation} by a \gls{g:scheduler}. When creating a new resource, it is useful to set \ApiCode{allocatable} to \ApiValue{false} and restrict the time when the \gls{g:resource} can by used for public scheduling (e.g., setup permanent reservations) and then modify the \ApiCode{allocatable} to \ApiValue{true}.
\ApiClassAttribute{maximumFuture}{DateTime}{\ApiOptional} The maximum future time for \glspl{g:reservation} as defined in \UCref{rsv:max-future}.
\ApiClassAttributeCollection{administrators}{List}{Person}{\ApiOptional} List of \ApiRef{Person}s that are notified when the \gls{g:resource} is allocated or when are encountered any technical issues.
\ApiClassAttributeCollection{childResourceIds}{List}{String}{\ApiReadOnly} List of child \glspl{g:resource} identifiers (e.g., the \gls{g:resource} can be a physical room and the collection \ApiCode{childResourceIds} contains all \glspl{g:endpoint} in the room).
\end{ApiClassAttributes}

\ApiClass{DeviceResource}{Resource}
Represents a complete \gls{g:resource-device} definition.
\begin{ApiClassAttributes}
\ApiClassAttribute{address}{String}{\ApiOptional} Address of the \gls{g:resource-device} (e.g., \ApiValue{147.251.1.1} or \ApiValue{connect.cesnet.cz}).
\ApiClassAttributeCollection{technologies}{Set}{Technology}{\ApiRequired}
Set of \glspl{g:technology} which are supported by the \gls{g:resource-device}.
\ApiClassAttribute{mode}{String,ManagedMode}{\ApiOptional} String value \ApiValue{UNMANAGED} specifies that the \gls{g:resource-device} is not managed by any \gls{g:connector-agent}. \ApiRef{ManagedMode}  specifies by which \gls{g:connector-agent} is the \gls{g:resource-device} managed.
\end{ApiClassAttributes}

\ApiClass{ManagedMode}{}
Represents a descriptor of \gls{g:connector-agent} by which a \gls{g:resource-device} can be managed.
\begin{ApiClassAttributes}
\ApiClassAttribute{connectorAgentName}{String}{\ApiRequired} Name of the \gls{g:connector-agent} which is managing the \gls{g:resource-device}.
\end{ApiClassAttributes}

\ApiClass{Capability}{}
Base class for all capabilities which a \gls{g:resource} can have. A \gls{g:resource} can have zero, one or multiple capabilities.
\begin{ApiClassAttributes}
\ApiClassAttribute{id}{String}{\ApiReadOnly} Identifier of the capability.
\end{ApiClassAttributes}

\ApiClass{RoomProviderCapability}{Capability} Capability for \glspl{g:device} which provides \glspl{g:device-virtual-room} for interconnecting multiple other \glspl{g:endpoint} (e.g., \gls{g:resource-device} for H.323 MCU will have the \ApiRef{RoomProviderCapability}).
\begin{ApiClassAttributes}
\ApiClassAttribute{licenseCount}{int}{\ApiRequired} Maximum number of licenses which can be allocated for all \glspl{g:device-virtual-room} at one moment.
\ApiClassAttributeCollection{requiredAliasTypes}{Set}{AliasType}{\ApiRequired} Collection of \ApiRef{AliasType}s which must be allocated for each \gls{g:device-virtual-room}.
\end{ApiClassAttributes}

\ApiClass{TerminalCapability}{Capability} Capability for \glspl{g:device} which can participate in a \gls{g:compartment}.
\begin{ApiClassAttributes}
\ApiClassAttributeCollection{aliases}{List}{Alias}{\ApiOptional} Collection of aliases of the terminal.
\end{ApiClassAttributes}

\ApiClass{StandaloneTerminalCapability}{TerminalCapability} Capability for \glspl{g:device} which can participate in a \gls{g:compartment} or which can connect to another \gls{g:device} (even without a \gls{g:device-virtual-room}).
(e.g., the \gls{g:resource-device} for a H.323 \gls{g:endpoint} will have the \ApiRef{StandaloneTerminalCapability} or the \gls{g:resource-device} for an Adobe Connect client will have the \ApiRef{TerminalCapability}).

\ApiClass{AliasProviderCapability}{Capability} Capability provides that the \gls{g:resource} can be allocated as a \gls{g:device-alias}.
\begin{ApiClassAttributes}
\ApiClassAttribute{valueProvider}{String|ValueProvider}{\ApiRequired} String value represents an identifier of \gls{g:resource} with \ApiRef{ValueProviderCapability} or \ApiRef{ValueProvider} defines new object which will be used for generating unique values.
\ApiClassAttributeCollection{aliases}{List}{Alias}{\ApiRequired} Collection of aliases (templates for them) which the generated alias values can represent (e.g., generated value \ApiValue{950087001} can represent a H.323 phone number \ApiValue{950087001} or SIP URI \ApiValue{sip:950087001@cesnet.cz}). Attribute \ApiCode{value} in \ApiRef{Alias} should specify \ApiValue{\{value\}} placeholder where the actual value will be placed (e.g., \ApiValue{"\{value\}"} for H.323 number or \ApiValue{"\{value\}@cesnet.cz"} for SIP URI).
\ApiClassAttribute{maximumFuture}{DateTime}{\ApiOptional} The maximum future time for \gls{g:device-alias} \glspl{g:reservation} as defined in \UCref{rsv:max-future} (can differ from the \gls{g:resource} \ApiCode{maximumFuture}).
\ApiClassAttribute{restrictedToResource}{boolean}{\ApiRequired} Specifies whether \glspl{g:device-alias} can be allocated only for the \gls{g:resource} which has this capability or for all other \glspl{g:resource-device}.
\ApiClassAttribute{permanentRoom}{boolean}{\ApiRequired} Specifies whether for \glspl{g:device-alias} should be created permanent \glspl{g:device-virtual-room} on the same \gls{g:resource-device} (it must have the \ApiRef{RoomProviderCapability}).
\end{ApiClassAttributes}

\ApiClass{ValueProvider}{} Abstract base class which represents an object which can generate unique string values.

\ApiClass{ValueProvider.Pattern}{ValueProvider} Represents \ApiRef{ValueProvider} which generates values from patterns.
\begin{ApiClassAttributes}
\ApiClassAttributeCollection{patterns}{List}{String}{\ApiRequired} Collection of patterns specifying which values will be generated as \gls{g:device-alias} (e.g., single \ApiValue{950087\{digit:3\}} pattern for generation of \ApiValue{950087001}, \ApiValue{950087002}, ... \ApiValue{950087999} values). 
\ApiClassAttribute{allowAnyRequestedValue}{boolean}{\ApiRequired} Specifies whether any value can be requested for allocation. If the option is disabled only values which match any of defined pattern can be requested.
\end{ApiClassAttributes}

\ApiEnum{FilterType}
\begin{ApiEnumValues}
\ApiEnumValue{CONVERT_TO_URL}{} Represents filter which converts any string to nice url string (it removes diascritical marks, converts the string to lower case, replaces spaces for dashes and removes all special signs except the dash and underscore).
\end{ApiEnumValues}

\ApiClass{ValueProvider.Filtered}{ValueProvider} Represents \ApiRef{ValueProvider} which use another \ApiRef{ValueProvider} for generating new values, but to requested values is applied filter. For example if value "Testing Value" is requested and filter type is \ApiCode{CONVERT\_TO\_URL}, then on given \ApiCode{valueProvider} is requested value "testing-value".
\begin{ApiClassAttributes}
\ApiClassAttribute{valueProvider}{ValueProvider}{\ApiRequired} Specifies \ApiRef{ValueProvider} which is used for generating new values.
\ApiClassAttribute{type}{FilterType}{\ApiRequired} Specifies type of the filter.
\end{ApiClassAttributes}

\ApiClass{ValueProviderCapability}{Capability} Capability tells that the \gls{g:resource} can allocate unique string values (which are required, e.g., for \ApiRef{AliasReservation}s).
\begin{ApiClassAttributes}
\ApiClassAttribute{valueProvider}{ValueProvider}{\ApiRequired} Specifies \ApiRef{ValueProvider} which is used for generating new values.
\end{ApiClassAttributes}

\ApiClass{ResourceSummary}{}
This class represents a summary of a \gls{g:resource}. The summary of a \gls{g:resource} is lightweight and does not contain all \gls{g:resource}'s attributes. It is suitable when listing a lot of \glspl{g:resource} from a \gls{g:controller} database where the detail information about \gls{g:resource} is not appropriate.
\begin{ApiClassAttributes}
\ApiClassAttribute{id}{String}{} \Gls{g:resource} unique identifier.
\ApiClassAttribute{userId}{String}{\ApiReadOnly} Identifier of the owner user who created the \gls{g:resource} in the \gls{g:controller}.
\ApiClassAttribute{name}{String}{} \Gls{g:resource} name which can be displayed.
\ApiClassAttribute{technologies}{String}{} Comma separated list of supported technologies.
\ApiClassAttribute{parentId}{String}{\ApiOptional} A parent \gls{g:resource} identifier in which is the \gls{g:resource} located.
\end{ApiClassAttributes}

\ApiEnum{ReservationRequestPurpose}
\begin{ApiEnumValues}
\ApiEnumValue{SCIENCE}{} \Gls{g:reservation} is requested for research purposes.
\ApiEnumValue{EDUCATION}{} \Gls{g:reservation} is requested for education purposes (e.g., for a lecture).
\end{ApiEnumValues}

\ApiEnum{ReservationRequestState}
Enumeration of possible states in which a \gls{g:reservation-request} can be.
\begin{ApiEnumValues}
\ApiEnumValue{NOT_COMPLETE}{} A \gls{g:reservation-request} is not ready for allocation by a \gls{g:scheduler} (e.g., some person requested by the \ApiRef{PersonSpecification} hasn't confirmed/rejected the invitation or he hasn't selected an endpoint by which he will connect to a \gls{g:compartment}).
\ApiEnumValue{NOT_ALLOCATED}{} A \gls{g:reservation-request} is ready for allocation by a \gls{g:scheduler}, but the \gls{g:scheduler} hasn't allocated it yet.
\ApiEnumValue{ALLOCATED}{} A \gls{g:reservation-request} has been successfully allocated by the \gls{g:scheduler} to a \gls{g:reservation}.
\ApiEnumValue{ALLOCATION_FAILED}{} The \gls{g:scheduler} has failed to allocate a \gls{g:reservation-request} to a \gls{g:reservation}.
\ApiEnumValue{STARTED}{} An allocated \gls{g:executable} for the \gls{g:reservation-request} (e.g. \gls{g:device-virtual-room}) has been successfully started by the \gls{g:executor}.
\ApiEnumValue{STARTING_FAILED}{} An allocated \gls{g:executable} for the \gls{g:reservation-request} (e.g. \gls{g:device-virtual-room}) has failed to start by the \gls{g:executor}.
\ApiEnumValue{FINISHED}{} An allocated \gls{g:executable} for the \gls{g:reservation-request} (e.g. \gls{g:device-virtual-room}) has been stopped by the \gls{g:executor} (after it was successfully started).
\end{ApiEnumValues}

\ApiClass{AbstractReservationRequest}{}
Represents a base class for all possible types \glspl{g:reservation-request}. It contains only common attributes which are same for all types of \glspl{g:reservation-request}.
\begin{ApiClassAttributes}
\ApiClassAttribute{id}{String}{\ApiReadOnly} \Gls{g:reservation-request} unique identifier as defined in \UCref{rsv:identification}.
\ApiClassAttribute{userId}{String}{\ApiReadOnly} Identifier of the owner user who created the \gls{g:reservation-request} in the \gls{g:controller}.
\ApiClassAttribute{created}{DateTime}{\ApiReadOnly} Date/time when the \gls{g:reservation-request} was created.
\ApiClassAttribute{description}{String}{\ApiOptional} Detailed \gls{g:reservation-request} description.
\end{ApiClassAttributes}

\ApiClass{PermanentReservationRequest}{AbstractReservationRequest}
Represents a permanent \gls{g:reservation-request} as defined in \UCref{rsv:reservation:permanent}.
\begin{ApiClassAttributes}
\ApiClassAttributeCollection{slots}{List}{DateTimeSlot}{\ApiRequired} List of requested \ApiCode{slots}.
\ApiClassAttribute{resourceId}{String}{\ApiRequired} Identifier of \gls{g:resource} for which the permanent \gls{g:reservation}(s) should be created. 
\ApiClassAttribute{report}{String}{\ApiReadOnly} Description of current state of permanent \gls{g:reservation-request} (can contain reasons, e.g., why the allocation of any reservations failed).
\ApiClassAttributeCollection{resourceReservations}{List}{ResourceReservation}{\ApiReadOnly} List of \glspl{g:reservation} which was already allocated for the \gls{g:resource}.
\end{ApiClassAttributes}

\ApiClass{NormalReservationRequest}{AbstractReservationRequest}
Represents an one time or periodic \gls{g:reservation-request} as defined in \UCref{rsv:reservation:one} and \UCref{rsv:reservation:periodic} (one time \gls{g:reservation-request} is a special case of periodic \gls{g:reservation-request}).
\begin{ApiClassAttributes}
\ApiClassAttribute{purpose}{ReservationRequestPurpose}{\ApiRequired} Purpose of the \gls{g:reservation-request}, see \ApiRef{ReservationRequestPurpose}.
\ApiClassAttribute{specification}{Specification}{\ApiRequired} Requested \ApiCode{specification} for a target which should be allocated.
\ApiClassAttribute{interDomain}{boolean}{\ApiOptionalDefault{false}} Specify whether the \gls{g:scheduler} should try allocate also \glspl{g:resource} from other \glspl{g:domain}.
\ApiClassAttributeCollection{providedReservationIds}{List}{String}{\ApiOptional} List of identifiers for \glspl{g:reservation} which are provided to the \gls{g:reservation-request} and the \gls{g:scheduler} can use all allocated \glspl{g:resource} from these \glspl{g:reservation} when allocating the \gls{g:reservation-request}.
\end{ApiClassAttributes}

\ApiClass{ReservationRequestSet}{NormalReservationRequest}
Represents a \gls{g:reservation-request} for one or multiple \glspl{g:reservation}. It specifies one or multiple date/time slots and one specification and for each slot will be created one \ApiCode{ReservationRequest}.
\begin{ApiClassAttributes}
\ApiClassAttributeCollection{slots}{List}{DateTimeSlot}{\ApiRequired} List of requested \ApiCode{slots}.
\ApiClassAttributeCollection{reservationRequests}{List}{ReservationRequest}{\ApiRequired} List of already created \ApiRef{ReservationRequest}s.
\end{ApiClassAttributes}

\ApiClass{ReservationRequest}{NormalReservationRequest}
Represents a \gls{g:reservation-request} for single specification at one specific date/time slot.
Only \ApiRef{ReservationRequest}s are processed by the \gls{g:scheduler} and the \gls{g:scheduler} allocates them to \glspl{g:reservation}. 
\begin{ApiClassAttributes}
\ApiClassAttribute{slot}{Interval}{\ApiRequired} Requested date/time \ApiCode{slot}.
\ApiClassAttribute{state}{ReservationRequestState}{\ApiReadOnly} Current state of the \gls{g:reservation-request}.
\ApiClassAttribute{stateReport}{String}{\ApiReadOnly} Description for the current state (can contain reason, e.g., why the allocation failed).
\ApiClassAttribute{reservationId}{String}{\ApiReadOnly} Identifier of allocated \gls{g:reservation} for this \gls{g:reservation-request}.
\end{ApiClassAttributes}

\ApiClass{Specification}{}
Represents a base class for all possible specifications. Each specification describes a target which is requested by a \gls{g:reservation-request}.
\begin{ApiClassAttributes}
\ApiClassAttribute{id}{String}{\ApiReadOnly} Identifier of the specification.
\end{ApiClassAttributes}

\ApiClass{ResourceSpecification}{Specification}
Represents a specification for an \gls{g:resource} which is stored in local or foreign \gls{g:domain} \gls{g:controller} and thus it has assigned a \gls{g:resource} identifier.
\begin{ApiClassAttributes}
\ApiClassAttribute{resourceId}{String}{\ApiRequired} \Gls{g:resource} identifier for the \gls{g:resource}.
\end{ApiClassAttributes}

\ApiClass{AliasSpecification}{Specification}
Represents a specification for an \gls{g:device-alias}.
\begin{ApiClassAttributes}
\ApiClassAttributeCollection{technologies}{Set}{Technology}{\ApiOptional} \Gls{g:technology} of the requested \gls{g:device-alias}.
\ApiClassAttributeCollection{aliasTypes}{Set}{AliasType}{\ApiOptional} Type of the requested \gls{g:device-alias}.
\ApiClassAttribute{value}{String}{\ApiOptional} Requested value for the \gls{g:device-alias}.
\ApiClassAttribute{resourceId}{String}{\ApiOptional} Identifier of a \gls{g:resource} with \ApiCode{AliasProviderCapability} which should be used as the alias provider.
\end{ApiClassAttributes}

\ApiClass{AliasGroupSpecification}{Specification}
Represents group of \ApiRef{AliasSpecification}.
\begin{ApiClassAttributes}
\ApiClassAttributeCollection{aliasSpecifications}{List}{AliasSpecification}{\ApiRequired}
\end{ApiClassAttributes}

\ApiClass{RoomSpecification}{Specification}
Represents a specification for a \gls{g:device-virtual-room}.
\begin{ApiClassAttributes}
\ApiClassAttribute{resourceId}{String}{\ApiOptional} Identifier of a preferred \gls{g:resource-device} with \ApiCode{RoomProviderCapability} where should be the \gls{g:device-virtual-room} created.
\ApiClassAttributeCollection{technologies}{Set}{Technology}{\ApiRequired} Set of \glspl{g:technology} which the \gls{g:device-virtual-room} must support.
\ApiClassAttribute{participantCount}{int}{\ApiRequired} Number of participants which must be able to connect to the \gls{g:device-virtual-room}.
\ApiClassAttributeCollection{roomSettings}{List}{RoomSetting}{\ApiOptional} List of settings for the \gls{g:device-virtual-room}.
\ApiClassAttributeCollection{aliasSpecifications}{List}{AliasSpecification}{\ApiOptional} List of specification for \glspl{g:device-alias} which should be allocated for the \gls{g:device-virtual-room}.
\end{ApiClassAttributes}

\ApiClass{RoomSetting}{}
Represents a base class for all settings for a \gls{g:device-virtual-room}.
\begin{ApiClassAttributes}
\ApiClassAttribute{id}{String}{\ApiReadOnly} Identifier of the setting.
\end{ApiClassAttributes}

\ApiClass{RoomSetting.H323}{RoomSetting}
Represents settings for a H.323 \gls{g:device-virtual-room}.
\begin{ApiClassAttributes}
\ApiClassAttribute{pin}{String}{\ApiOptional} PIN that must be entered to get to the room.
\end{ApiClassAttributes}

\ApiClass{RoomSetting.AdobeConnect}{RoomSetting}
Represents settings for an Adobe Connect \gls{g:device-virtual-room}.
\begin{ApiClassAttributes}
\ApiClassAttributeCollection{participants}{List}{String}{\ApiOptional} List of participants identifiers which are allowed to enter the room. \newline\todo{EPPN or Perun ID?}
\end{ApiClassAttributes}

\ApiClass{CompartmentSpecification}{Specification}
Represents a specification for a group of participants which should participate a single \gls{g:compartment}.
\begin{ApiClassAttributes}
\ApiClassAttributeCollection{specifications}{List}{ParticipantSpecification}{\ApiRequired} List of specifications for participants which should participate in a \gls{g:compartment}.
\ApiClassAttribute{callInitiation}{CallInitiation}{\ApiOptional} Default \ApiCode{CallInitiation} in the \gls{g:compartment}.
\end{ApiClassAttributes}

\ApiClass{MultiCompartmentSpecification}{Specification}
Represents a specification for a group of compartments. Each can be for different technology 
and compartments will not be interconnected (e.g., one compartment in H.323 technology for 
videoconference and other compartment for web conferencing technology to share content).
\begin{ApiClassAttributes}
\ApiClassAttributeCollection{specifications}{List}{CompartmentSpecification}{\ApiRequired} List of compartment specifications.
\end{ApiClassAttributes}

\ApiClass{ParticipantSpecification}{Specification}
Represents a base class for specifications which can be added to the \ApiRef{CompartmentSpecification}.

\ApiClass{ExternalEndpointSpecification}{ParticipantSpecification}
Represents a specification for an external \gls{g:endpoint}. An external \gls{g:endpoint} doesn't have assigned a \gls{g:resource} identifier.
\begin{ApiClassAttributes}
\ApiClassAttributeCollection{technologies}{Set}{Technology}{\ApiRequired} Set of \glspl{g:technology} of the external \gls{g:endpoint}.
\ApiClassAttribute{alias}{Alias}{\ApiOptional} \Gls{g:device-alias} of the external \gls{g:endpoint}.
\end{ApiClassAttributes}

\ApiClass{ExternalEndpointSetSpecification}{ParticipantSpecification}
Represents a specification for one or multiple external \glspl{g:endpoint}. An external \gls{g:endpoint} doesn't have assigned a \gls{g:resource} identifier.
\begin{ApiClassAttributes}
\ApiClassAttributeCollection{technologies}{Set}{Technology}{\ApiRequired} Set of \glspl{g:technology} of the external \gls{g:endpoint}.
\ApiClassAttribute{count}{int}{\ApiOptional} Number of the external \gls{g:endpoint} (all have the same \gls{g:technology}).
\end{ApiClassAttributes}

\ApiClass{ExistingEndpointSpecification}{ParticipantSpecification}
Represents a specification for an \gls{g:endpoint} which is stored in local or foreign \gls{g:domain} \gls{g:controller} and thus it has assigned a \gls{g:resource} identifier.
\begin{ApiClassAttributes}
\ApiClassAttribute{resourceId}{String}{\ApiRequired} \Gls{g:resource-device} identifier for the \gls{g:endpoint}.
\end{ApiClassAttributes}

\ApiClass{LookupEndpointSpecification}{ParticipantSpecification}
Represents a specification of parameters for an \gls{g:endpoint} which will be used to lookup a matching \gls{g:endpoint} in local or foreign \gls{g:domain} \gls{g:controller}.
\begin{ApiClassAttributes}
\ApiClassAttribute{technology}{Technology}{\ApiRequired} \Gls{g:technology} of the requested \gls{g:endpoint}.
\end{ApiClassAttributes}

\ApiClass{PersonSpecification}{ParticipantSpecification}
Represents a specification for a person that should participate in a \gls{g:compartment}.
\begin{ApiClassAttributes}
\ApiClassAttribute{person}{Person}{\ApiRequired} Requested person.
\end{ApiClassAttributes}

\ApiClass{ReservationRequestSummary.Type}{}
Abstract base class which represents a type of \ApiRef{ReservationRequestSummary}.

\ApiClass{ReservationRequestSummary.PermanentType}{ReservationRequestSummary.Type}
Represents a type for \ApiRef{PermanentReservationRequest}.
\begin{ApiClassAttributes}
\ApiClassAttribute{resourceId}{String}{} \Gls{g:resource} identifier.
\end{ApiClassAttributes}

\ApiClass{ReservationRequestSummary.RoomType}{ReservationRequestSummary.Type} 
Represents a type for \ApiRef{NormalReservationRequest} with \ApiRef{RoomSpecification}.
\begin{ApiClassAttributes}
\ApiClassAttribute{participantCount}{Integer}{} Requested participant count for the \gls{g:device-virtual-room}.
\ApiClassAttribute{roomName}{Integer}{} Requested name for the \gls{g:device-virtual-room}.
\end{ApiClassAttributes}

\ApiClass{ReservationRequestSummary.AliasType}{ReservationRequestSummary.Type}
Represents a type for \ApiRef{NormalReservationRequest} with \ApiRef{AliasSpecification}.
\begin{ApiClassAttributes}
\ApiClassAttribute{aliasType}{AliasType}{} Requested type of \gls{g:device-alias}.
\ApiClassAttribute{value}{String}{} Requested value of \gls{g:device-alias}.
\end{ApiClassAttributes}

\ApiClass{ReservationRequestSummary}{}
This class represents a summary of a \gls{g:reservation-request}. The summary is lightweight and does not contain all \gls{g:reservation-request} attributes. It is suitable when listing a lot of \glspl{g:reservation-request} from the \gls{g:controller} database where the detail information about \gls{g:reservation-request} is not appropriate.
\begin{ApiClassAttributes}
\ApiClassAttribute{id}{String}{} \Gls{g:reservation-request} unique identifier as defined in \UCref{rsv:identification}.
\ApiClassAttribute{userId}{String}{} Identifier of \gls{g:reservation-request} owner.
\ApiClassAttribute{created}{DateTime}{} Date/time when the \gls{g:reservation-request} was created.
\ApiClassAttribute{type}{ReservationRequestSummary.Type}{} Type of the \gls{g:reservation-request}, see \ApiRef{ReservationRequestSummary.Type}.
\ApiClassAttribute{name}{String}{} Name of the \gls{g:reservation-request}.
\ApiClassAttribute{purpose}{ReservationRequestPurpose}{} Purpose of the \gls{g:reservation-request}, see \ApiRef{ReservationRequestPurpose}.
\ApiClassAttribute{description}{String}{} Description of \gls{g:reservation-request}.
\ApiClassAttribute{earliestSlot}{Interval}{} Specifies the first future date/time slot for which the \gls{g:reservation} is requested.
\ApiClassAttribute{state}{ReservationRequestSummaryState}{} Specifies the current state of the \gls{g:reservation-request}. 
\end{ApiClassAttributes}

\ApiClass{Reservation}{}
Represents base class for all possible types of successfully allocated \gls{g:reservation}(s) for a \gls{g:reservation-request}. It contains only read only data that are obtained from a \gls{g:scheduler}.
\begin{ApiClassAttributes}
\ApiClassAttribute{id}{String}{} \Gls{g:reservation} unique identifier as defined in \UCref{rsv:identification}.
\ApiClassAttribute{userId}{String}{} Identifier of the \gls{g:reservation} owner.
\ApiClassAttribute{reservationRequestId}{String}{} Identifier of the \gls{g:reservation-request} for which the \gls{g:reservation} is allocated.
\ApiClassAttribute{slot}{Interval}{} Date/time slot for which the \gls{g:reservation} is allocated.
\ApiClassAttribute{parentReservationId}{String}{} Identifier of parent \gls{g:reservation}.
\ApiClassAttributeCollection{childReservationIds}{List}{String}{} Identifiers of child \glspl{g:reservation}. Each \gls{g:reservation} can contain multiple child \glspl{g:reservation} which have been allocated to satisfy the parent \gls{g:reservation} needs.
\ApiClassAttribute{executable}{Executable}{} \Gls{g:executor} plan.
\end{ApiClassAttributes}

\ApiClass{ResourceReservation}{Reservation}
Represents a successfully allocated \gls{g:resource}.
\begin{ApiClassAttributes}
\ApiClassAttribute{resourceId}{String}{} Allocated \gls{g:resource} identifier.
\ApiClassAttribute{resourceName}{String}{} Allocated \gls{g:resource} name. 
\end{ApiClassAttributes}

\ApiClass{RoomReservation}{ResourceReservation}
Represents a successfully allocated \gls{g:resource-device} as a \gls{g:device-virtual-room}.
\begin{ApiClassAttributes}
\ApiClassAttribute{licenseCount}{String}{} Number of allocated ports for the \gls{g:device-virtual-room}.
\end{ApiClassAttributes}

\ApiClass{ValueReservation}{ResourceReservation}
Represents a successfully allocated \gls{g:resource} as a unique value.
\begin{ApiClassAttributes}
\ApiClassAttribute{value}{String}{} Unique value which is allocated.
\end{ApiClassAttributes}

\ApiClass{AliasReservation}{ResourceReservation}
Represents a successfully allocated \gls{g:resource} as a \gls{g:device-alias}.
\begin{ApiClassAttributes}
\ApiClassAttribute{valueReservation}{ValueReservation}{} Allocated value for one or multiple \glspl{g:device-alias}.
\ApiClassAttributeCollection{aliases}{List}{Alias}{} List of \glspl{g:device-alias} which are allocated.
\end{ApiClassAttributes}

\ApiClass{ExistingReservation}{Reservation}
Represents a reused \gls{g:reservation} (which was provided to the \gls{g:reservation-request}).
\begin{ApiClassAttributes}
\ApiClassAttribute{reservation}{Reservation}{} Existing \gls{g:reservation} which is reused.
\end{ApiClassAttributes}

\ApiClass{Executable}{}
Represents an \gls{g:executor} plan.
\begin{ApiClassAttributes}
\ApiClassAttribute{id}{String}{} Unique identifier of the \gls{g:executor} plan.
\ApiClassAttribute{userId}{String}{} Identifier of the \gls{g:executable} owner.
\ApiClassAttribute{slot}{Interval}{} Date/time slot when the plan should be executed.
\ApiClassAttribute{state}{Executable.State}{} Current state of the \gls{g:executor} plan.
\end{ApiClassAttributes}

\ApiEnum{Executable.State}
\begin{ApiEnumValues}
\ApiEnumValue{NOT_STARTED}{} \ApiRef{Executable} has not been started yet
\ApiEnumValue{STARTED}{} \ApiRef{Executable} is already started.
\ApiEnumValue{STARTING_FAILED}{} \ApiRef{Executable} failed to start.
\ApiEnumValue{STOPPED}{} \ApiRef{Executable} has been already stopped.
\ApiEnumValue{STOPPING_FAILED}{} \ApiRef{Executable} failed to stop.
\end{ApiEnumValues}

\ApiClass{Executable.Compartment}{Executable}
Represents an allocated \gls{g:compartment}.
\begin{ApiClassAttributes}
\ApiClassAttributeCollection{endpoints}{List}{Executable.Endpoint}{} List of participating \glspl{g:endpoint}.
\ApiClassAttributeCollection{rooms}{List}{Executable.ResourceRoom}{} List of \glspl{g:device-virtual-room}.
\ApiClassAttributeCollection{connections}{List}{Executable.Connection}{} List of connection between \glspl{g:endpoint} and \glspl{g:device-virtual-room}.
\end{ApiClassAttributes}

\ApiClass{Executable.Endpoint}{}
Represents an \gls{g:endpoint} in allocated \gls{g:compartment}.
\begin{ApiClassAttributes}
\ApiClassAttribute{id}{String}{} Identifier of the \gls{g:endpoint}.
\ApiClassAttribute{description}{String}{} Description of the \gls{g:endpoint}.
\ApiClassAttributeCollection{aliases}{List}{Alias}{} List of assigned \glspl{g:device-alias} to the \gls{g:endpoint}.
\end{ApiClassAttributes}

\ApiClass{Executable.ResourceRoom}{Executable}
Represents an \gls{g:executor} plan for a \gls{g:device-virtual-room}.
\begin{ApiClassAttributes}
\ApiClassAttribute{resourceId}{String}{} Identifier of \gls{g:resource-device} in which the \gls{g:device-virtual-room} will be started.
\ApiClassAttributeCollection{technologies}{List}{Technology}{} Set of technologies which the \gls{g:device-virtual-room} will support.
\ApiClassAttribute{licenseCount}{int}{} Number of available ports in the \gls{g:device-virtual-room}
\ApiClassAttributeCollection{aliases}{List}{Alias}{} List of assigned \glspl{g:device-alias} to the \gls{g:device-virtual-room}.
\ApiClassAttributeCollection{roomSettings}{List}{RoomSetting}{\ApiOptional} List of settings for the \gls{g:device-virtual-room}.
\end{ApiClassAttributes}

\ApiClass{Executable.Connection}{}
Represents an connection between two \glspl{g:endpoint} in allocated \gls{g:compartment}.
\begin{ApiClassAttributes}
\ApiClassAttribute{endpointFromId}{String}{} Identifier of the source \gls{g:endpoint} which initiates the call.
\ApiClassAttribute{endpointToId}{String}{} Identifier of the target \gls{g:endpoint}.
\ApiClassAttribute{alias}{Alias}{} \Gls{g:device-alias} which is used for the connection.
\end{ApiClassAttributes}

\ApiClass{ResourceAllocation}{}
Represents an information about allocation of \gls{g:resource}.
\begin{ApiClassAttributes}
\ApiClassAttribute{id}{String}{} \Gls{g:resource} identifier.
\ApiClassAttribute{name}{String}{} \Gls{g:resource} name.
\ApiClassAttribute{interval}{Interval}{} Interval for which the allocation information is contained.
\ApiClassAttributeCollection{reservations}{List}{ResourceReservation}{} List of \glspl{g:reservation} for the \gls{g:resource}.
\end{ApiClassAttributes}

\ApiClass{RoomProviderResourceAllocation}{ResourceAllocation}
Represents an information about allocation of \gls{g:resource-device} with \glspl{g:device-virtual-room}.
\begin{ApiClassAttributes}
\ApiClassAttribute{maximumPortCount}{int}{} Maximum port count which are available in the \Gls{g:resource-device} for all \glspl{g:device-virtual-room} at one moment.
\ApiClassAttribute{availablePortCount}{int}{} Available port count which are available in the \Gls{g:resource-device} for \ApiCode{interval}.
\end{ApiClassAttributes}


\end{Api}

\section{Common}

\begin{Api}

\ApiItem{\ApiCode{Controller getController()}}
Get information about the domain controller. See \ApiRef{Controller} class.

\ApiItem{\ApiCode{Collection<Domain> listDomains(SecurityToken token)}}
Lists all known domains with status if they are available to the domain controller.

\ApiItem{\ApiCode{Collection<Connector> listConnectors(SecurityToken token)}}
Lists all known connectors in the controlled domain.

\end{Api}


\section{Resources}

\begin{Api}

\begin{ApiCmd}{String}{createResource}%
\ApiCmdParam{SecurityToken}{token}%
\ApiCmdParam{Resource}{resource}%
\end{ApiCmd}
Create a new resource that will be stored in the domain controller. The new resource identifier is returned as a result. The user with given \ApiCode{token} will be the resource owner. The \ApiCode{resource} must contain all attributes marked as \ApiRequired.

\begin{ApiCmd}{void}{modifyResource}%
\ApiCmdParam{SecurityToken}{token}%
\ApiCmdParam{Resource}{resource}%
\end{ApiCmd}
Modify the given resource. Attribute \ApiCode{id} must be filled and identifies the resource to be modified. That operation is permited only when the user with given \ApiCode{token} is the resource owner. The \ApiCode{resource} should contain only attributes to be modified.

\begin{ApiCmd}{void}{deleteResource}%
\ApiCmdParam{SecurityToken}{token}%
\ApiCmdParam{String}{resourceId}%
\end{ApiCmd}
Delete the resource with specified \ApiCode{resourceId} from Shongo management. That operation is permited only when the user with given \ApiCode{toke}| is the resource owner and only when the resource is not used in any future reservation.

\begin{ApiCmdCollection}{Collection}{ResourceSummary}{listResources}%
\ApiCmdParam{SecurityToken}{token}%
\ApiCmdParamMap{String}{Object}{filter}%
\end{ApiCmdCollection}
List of resource summaries managed by Shongo, that a user with given \ApiCode{token} is entitled to see.
The \ApiCode{filter} map can contain following attributes to filter results:
\begin{compactitem}
\item \ApiCode{userId} restricts resource owner by his identifier
\end{compactitem}

\begin{ApiCmd}{Resource}{getResource}%
\ApiCmdParam{SecurityToken}{token}%
\ApiCmdParam{String}{resourceId}%
\end{ApiCmd}
Get the complete resource object for specified \ApiCode{resourceId} that a user with given \ApiCode{token} is entitled to see. See \ApiRef{Resource} for details.

\begin{ApiCmd}{ResourceAllocation}{getResourceAllocation}%
\ApiCmdParam{SecurityToken}{token}%
\ApiCmdParam{String}{resourceId}%
\ApiCmdParam{Interval}{interval}%
\end{ApiCmd}
Get the allocation of resource object for specified \ApiCode{resourceId} in given \ApiCode{interval} that a user with given \ApiCode{token} is entitled to see. See \ApiRef{ResourceAllocation} for details.

\end{Api}


\section{Reservations}

\begin{Api}

\begin{ApiCmd}{String}{createReservationRequest}%
\ApiCmdParam{SecurityToken}{token}%
\ApiCmdParam{AbstractReservationRequest}{reservationRequest}%
\end{ApiCmd}
Create a new reservation. The new reservation identifier is returned as a result. The \ApiCode{reservationRequest} must contain all attributes marked as \ApiRequired.

\begin{ApiCmd}{String}{modifyReservationRequest}%
\ApiCmdParam{SecurityToken}{token}%
\ApiCmdParam{AbstractReservationRequest}{reservationRequest}%
\end{ApiCmd}
Modify the reservation. Attribute \ApiCode{id} must be filled and identifies the reservation request to be modified. The \ApiCode{reservationRequest} should contain only attributes to be modified.

\begin{ApiCmd}{String}{deleteReservationRequest}%
\ApiCmdParam{SecurityToken}{token}%
\ApiCmdParam{String}{reservationRequestId}%
\end{ApiCmd}
Release the reservation with specified \ApiCode{reservationId}. The child reservations remain untouched.

\begin{ApiCmdCollection}{Collection}{ReservationRequestSummary}{listReservationRequests}%
\ApiCmdParam{SecurityToken}{token}%
\ApiCmdParamMap{String}{Object}{filter}%
\end{ApiCmdCollection}
List all the reservation requests that a user with given \ApiCode{token} is entitled to see. Only the lightweight definitions of reservation requests are returned, see \ApiRef{ReservationRequestSummary} for details. The \ApiCode{filter} map can contain following attributes to filter results:
\begin{compactitem}
\item \ApiCode{userId} -- restricts reservation request owner by his identifier
\item \ApiCode{technology} -- set of technologies of virtual room or compartment
\item \ApiCode{specificationClass} -- set of specification classes which the requests can specify
\item \ApiCode{providedReservationId} -- restricts reservation requests to which must be provided reservation with given identifier
\end{compactitem}

\begin{ApiCmd}{AbstractReservationRequest}{getReservationRequest}%
\ApiCmdParam{SecurityToken}{token}%
\ApiCmdParam{String}{reservationRequestId}%
\end{ApiCmd}
Get the reservation request for specified \ApiCode{reservationId} that a user with given \ApiCode{token} is entitled to see. The returned object contains requested time slots, requested compartments, child reservations and all other attributes that can be modified. It does not contain the read only scheduler allocation information which can be obtained by \ApiCode{getReservationAllocation}.

\begin{ApiCmdCollection}{Collection}{Reservation}{listReservations}%
\ApiCmdParam{SecurityToken}{token}%
\ApiCmdParamMap{String}{Object}{filter}%
\end{ApiCmdCollection}
List allocated reservations that a user with given \ApiCode{token} is entitled to see.
The \ApiCode{filter} map can contain following attributes to filter results:
\begin{compactitem}
\item \ApiCode{userId} -- restricts reservation owner by his identifier
\item \ApiCode{reservationRequestId} -- restricts reservation request for which the reservation is allocated
\item \ApiCode{reservationClass} -- set of allowed reservation classes
\item \ApiCode{technology} -- set of technologies of virtual room or compartment
\end{compactitem}

\begin{ApiCmd}{Reservation}{getReservation}%
\ApiCmdParam{SecurityToken}{token}%
\ApiCmdParam{String}{reservationId}%
\end{ApiCmd}
Get reservation with given \ApiCode{reservationId} that a user with given \ApiCode{token} is entitled to see.

\end{Api}

\section{Resource Control}

\todo{}
%\begin{Api}
%\end{Api}



