\chapter{Common Data Types}

\input{commands}

In this chapter common atomic types, enum types and object classes for Shongo API are described.

\section{Failure Related}

Each failure in API is reported by |faultCode| (number value) and |faultString| (description text). List of common faults:

\begin{ApiFailures}

\ApiFailure{0} Unknown fault which is described by |faultString|.

\ApiFailure{10} The \ApiValue{class} is not defined, the |faultString| specifies which \ApiValue{class}.
\ApiFailure{11} The \ApiValue{class} cannot be instanced, the |faultString| specifies which \ApiValue{class}.
\ApiFailure{12} The attribute is not defined, the |faultString| specifies which attribute in which class.
\ApiFailure{13} The attribute type is wrong, the |faultString| specifies which attribute in which class and also it specifies the present and required type.
\ApiFailure{14} The attribute wasn't present and is required, the |faultString| specifies which attribute in which class.
\ApiFailure{15} The collection is empty and is required, the |faultString| specifies which collection in which class.
\ApiFailure{16} The attribute was present but is read-only, the |faultString| specifies which attribute in which class.
\ApiFailure{17} Wrong value for attribute was present, the |faultString| specifies which value in which attribute in which class.

\ApiFailure{20} The value of an enum attribute is wrong, the |faultString| specifies which value.
\ApiFailure{21} Failed to parse date/time value, the |faultString| specifies which date/time value.
\ApiFailure{22} Failed to parse period value, the |faultString| specifies which period value.
\ApiFailure{23} Failed to parse interval value, the |faultString| specifies which interval value.
\ApiFailure{24} Failed to parse partial date/time value, the |faultString| specifies which partial date/time value.

\ApiFailure{30} Item with wrong type was present in collection, the |faultString| specifies which item in which collection and types which are allowed.
\ApiFailure{31} Null value cannot be used as item in collection, the |faultString| specifies which collection.

\ApiFailure{40} Entity was not found, the |faultString| specifies which entity.
\ApiFailure{41} Entity validation failed, the |faultString| specifies which entity.

\ApiFailure{99} The request is not implemented yet. An application log must be checked for more details.

\end{ApiFailures}

These are only common faults that are independent on specific API section. Other business logic faults can be generated and are described in appropriate API section.


\section{Security and Identity Related}

\begin{Api}

\ApiClass{UserIdentity}{}
Each user that accesses shongo or participates in shongo managed videoconference should be identified by |UserIdentity| definition.

\begin{ApiClassAttributes}
\ApiClassAttribute{id}{String}{\ApiRequired}
Equals to eduID identity. In future there can be unique identifier that associates multiple eduID for the same person.
\end{ApiClassAttributes}

\todo{Consider usage of Person instead of UserIdentity or vice versa}

\ApiClass{SecurityToken}{}
Contains identity and credentials of a user performing the requested operation.
\begin{ApiClassAttributes}
\item \todo{Authorization data}
\end{ApiClassAttributes}

\ApiClass{Person}{}
Represents a person that can access a Shongo videoconference.
\begin{ApiClassAttributes}
\ApiClassAttribute{name}{String}{\ApiRequired} Name to be displayed.
\ApiClassAttribute{email}{String}{\ApiRequired} Email to which a videoconference invitation should be sent.
\end{ApiClassAttributes}

\end{Api}


\section{Time Related}

\begin{Api}

\ApiType{Period}{String}
Used for representing period or duration. Format is specified by ISO8601 period (e.g., \ApiValue{P3Y6M4DT12H30M5S} which is \textit{3 years, 6 months, 4 days, 12 hours, 30 minutes, and 5 seconds} or \ApiValue{P4W} which is \textit{4 weeks}). The first character "\ApiValue{P}" means period and it comes from the ISO8601 standard. Components can be omitted (e.g.,~\ApiValue{P3YT12H} which is \textit{3 years and 12 hours}). The zero duration is represented by \ApiValue{PT0S} value (which is \textit{0 seconds}).

\ApiExample We want to set videoconference duration:
\begin{quote}
\begin{verbatim}
duration = PT2H
\end{verbatim}
\end{quote}

\ApiType{DateTime}{String}
Used for representing an absolute date/time. Format is specified by ISO8601 date/time in UTC (e.g., 20120130T10:09:55) or with explicit timezone specification (e.g., 20120130T10:09:55+02:00).

\ApiExample We want to create a new reservation for resources at the precise date. We can specify it by |DateTime|:
\begin{quote}
\begin{verbatim}
dateTime = 2012-12-31T12:00
\end{verbatim}
\end{quote}

\ApiType{RelativeDateTime}{Period}
Used for representing a relative date/time. Relative date/time can be evaluated to absolute date/time by specifying a referenced absolute date/time.

\ApiExample We want to define a maximum future to which a resource can be scheduled. We can specify it by |RelativeDateTime| as follows:
\begin{quote}
\begin{verbatim}
relativeDateTime = P4M
\end{verbatim}
\end{quote}
The \ApiValue{relativeDateTime} can be evaluated by using reference date/time \ApiValue{2012-01-01T00:00} to \ApiValue{2012-05-01T00:00}.

\ApiClass{PeriodicDateTime}{}
It can be used for events that takes place repeatedly, but also for events that take place only once.

\begin{ApiClassAttributes}
\ApiClassAttribute{start}{DateTime}{\ApiRequired}
Defines the first occurrence of an event.
\ApiClassAttribute{period}{Period}{\ApiOptional}
Defines the period in which the repeated events take place. See |Period| for format specification.
\ApiClassAttribute{end}{DateTime}{\ApiOptional}
Ending date/time for events to not occur forever (not required, we can specify infinite periodic date/time).
\ApiClassAttribute{rules}{Rule[]}{\ApiOptional}
List of rules, which can define an extra events out of the periodicity or cancel specified periodical events. |Rule| can be one of the following types:
\begin{compactitem}
\item |Enable|/|Disable| event(s) in the specified |dateTime| or interval by |start| and |end|.
\item |Extra| event in the specified |dateTime|
\end{compactitem}
Rules contains implicit definition of |Enable| rule for whole |PeridiocDateTime| interval. Conflicts are solved by \emph{last-match} policy.
\end{ApiClassAttributes}

\ApiExample Only one lecture on 20.3.2012.
\begin{quote}
\begin{verbatim}
periodicDateTime.start = 20110908T12:00:00
\end{verbatim}
\end{quote}

\ApiExample A lecture on every Thursday at 12:00 with extra lecture on 20.3.2012 and Christmas holidays.
\begin{quote}
\begin{verbatim}
periodicDate.start = 20110908T12:00:00
periodicDate.period = P1W
periodicDate.end = 20120631
periodicDate.rules = {
    { type = Disable, from = 20111219, to = 20120101 },
    { type = Extra, dateTime = 20120320 }
}
\end{verbatim}
\end{quote}

\ApiType{Interval}{String}
Represents the time between two instants. Values must be in format \ApiValue{<start>,<duration>} where \ApiValue{<start>} is in |DateTime| format and \ApiValue{<duration>} in |Period| format.

\end{Api}


\section{Other} \label{sect:common:other}

\begin{Api}

\ApiEnum{Technology}
Enumeration of supported (or planned to be supported) videoconference technologies.
\begin{ApiEnumValues}
\ApiEnumValue{H323}{}
\ApiEnumValue{SIP}{}
\ApiEnumValue{ADOBE_CONNECT}{}
\ApiEnumValue{SKYPE}{}
\ApiEnumValue{BIG_BLUE_BUTTON}{}
\ApiEnumValue{OPEN_MEETING}{}
\ApiEnumValue{WEBEX}{}
\end{ApiEnumValues}


%\ApiClass{Resolution}{}
%\todo{Not implemented yet}
%\begin{ApiClassAttributes}
%\ApiClassAttribute{width}{Integer}{\ApiRequired}
%\ApiClassAttribute{height}{Integer}{\ApiRequired}
%\end{ApiClassAttributes}
%\begin{ApiEnumValues}
%\ApiEnumValue{QCIF}{176x144}
%\ApiEnumValue{CIF}{352x288}
%\ApiEnumValue{4CIF}{704x576}
%\ApiEnumValue{720p}{1280x720}
%\ApiEnumValue{1080p}{1920x1080}
%\ApiEnumValue{2K}{2048x1080}
%\ApiEnumValue{4K}{4096x2160}
%\end{ApiEnumValues}


%\ApiEnum{AudioCodec}
%\todo{Not implemented yet}
%\begin{ApiEnumValues}
%\ApiEnumValue{MP3}{}
%\ApiEnumValue{AC3}{}
%\end{ApiEnumValues}


%\ApiEnum{VideoCodec}
%\todo{Not implemented yet}
%\begin{ApiEnumValues}
%\ApiEnumValue{H261}{}
%\ApiEnumValue{H263}{}
%\ApiEnumValue{H264}{}
%\end{ApiEnumValues}


%\ApiClass{Format}{}
%\todo{Not implemented yet}
%\begin{ApiClassAttributes}
%\ApiClassAttribute{technology}{Technology}{\ApiRequired}
%\ApiClassAttribute{audio}{AudioCodec}{\ApiRequired}
%\ApiClassAttribute{video}{VideoCodec}{\ApiRequired}
%\ApiClassAttribute{resolution}{Resolution}{\ApiRequired}
%\end{ApiClassAttributes}
%Can be represented by string:
%\begin{verbatim}
%<technology>:<audio>:<video>:<resolution>
%\end{verbatim}


\ApiClass{RoomUser}{}
Represents an active user in a virtual room on a server.
\begin{ApiClassAttributes}
\ApiClassAttribute{userId}{String}{\ApiReadOnly}
User identification in room (technology specific).
\ApiClassAttribute{roomId}{String}{\ApiReadOnly}
Room unique identifier. \todo{The identifier should contain a part denoting the user and a part denoting his/her session -- as requested by use case \ref{UC:ops:room:users-list}. resolved on the UserIdentity level}
\ApiClassAttribute{userIdentity}{UserIdentity}{\ApiReadOnly}
User identity which in some cases may be \ApiValue{null} (e.g., when the user is calling from cell phone).
\ApiClassAttribute{joinTime}{DateTime}{} Date and time when the user joined the room.
\ApiClassAttribute{muted}{boolean}{}
Is the user muted?
\ApiClassAttribute{microphoneLevel}{int}{}
Microphone level.
\ApiClassAttribute{playbackLevel}{int}{}
Playback level (speakers volume)
\ApiClassAttribute{layout}{RoomLayout}{\ApiOptional}
User layout, overriding the room default layout.
\end{ApiClassAttributes}

\end{Api}

