<h1>Detail of reservation request for [%- technologies -%]
[%- IF request.specification.class == 'RoomSpecification' %] room capacity
[%- ELSIF request.specification.class == 'AliasSpecification' || request.specification.class == 'AliasGroupSpecification' %] alias
[%- END -%]
</h1>

<script type="text/javascript">
    window.showNode = function(nodeId, show) {
        var stateReport = document.getElementById(nodeId);
        if ( show == null ) {
            show = stateReport.style.display == 'none';
        }
        stateReport.style.display = show ? 'block' : 'none';
    };
</script>

<dl class="dl-horizontal">

    <dt>Identifier:</dt>
    <dd>[% request.id %]</dd>

    <dt>Description:</dt>
    <dd>[% request.description %]</dd>

    <dt>Purpose:</dt>
    <dd>[% request.purpose %]</dd>

[%- IF request.specification.class == 'RoomSpecification' -%]

    <dt>Start date/time:</dt>
    <dd>[% util.format_datetime(request.start) %]</dd>

    <dt>Duration:</dt>
    <dd>[% util.format_period(request.duration) %]</dd>

    <dt>Periodicity:</dt>
    <dd>[% request.periodicity %] [% IF request.periodicityEnd %](end: [% util.format_partial_datetime(request.periodicityEnd) %])[% END %]</dd>
    [%- aliasReservation = request.providedReservations.0 %]
    [%- IF aliasReservation %]

    <dt>Room Alias:</dt>
    <dd><a href="[% location %]/detail?id=[% aliasReservation.reservationRequestId %]">[% aliasReservation.roomName %]</a> (valid in [% util.format_interval_date(aliasReservation.slot) %])</dd>
    [% END %]

    <dt>Number of participants:</dt>
    <dd>[% request.participantCount %]</dd>

[%- ELSIF request.specification.class == 'AliasSpecification' || request.specification.class == 'AliasGroupSpecification' -%]

    [% childRequest = request.childRequests.0 -%]

    <dt>Validity:</dt>
    <dd>[% util.format_date(request.start) %]/[% util.format_date(request.end) %]</dd>

    <dt>State:</dt>
    <dd>
        [%- IF childRequest.stateReport -%]
            [% childRequest.stateReport = '<pre>' _ childRequest.stateReport _ '</pre>' %]
        [%- END -%]
        [%- INCLUDE common/text_with_tooltip.html
                class        = 'state-' _ childRequest.stateCode
                text         = childRequest.state
                tooltipId    = 'state-report-' _ loop.index
                tooltipClass = 'state-report'
                tooltipText  = childRequest.stateReport
        -%]
    </dd>

    <dt>Room Name:</dt>
    <dd>[% childRequest.reservation.roomName %][% '<span class="empty">None</span>' IF !childRequest.reservation.roomName %]</dd>

    <dt>Allocated Alias(es):</dt>
    <dd>
        [% INCLUDE common/text_with_tooltip.html
                text         = childRequest.reservation.aliases
                tooltipId    = 'aliases-description-' _ loop.index
                tooltipClass = 'aliases-description'
                tooltipText  = childRequest.reservation.aliasesDescription
        -%]
        [% '<span class="empty">None</span>' IF !childRequest.reservation.aliases %]
    </dd>

[%- END -%]

[%- FOREACH attribute IN request.attributes %]

    <dt>[% attribute.name %]</dt>
    <dd>[% attribute.value %]</dd>

[%- END -%]

</dl>

[% IF request.specification.class == 'RoomSpecification' -%]
[% INCLUDE common/detail_room.html %]
[% END -%]

[%- IF request.specification.class == 'AliasSpecification' || request.specification.class == 'AliasGroupSpecification' -%]
[% INCLUDE common/detail_alias.html %]
[% END -%]

<div class="pull-right">
    <a class="btn btn-primary" href="[% back %]">Back</a>
    [%- IF request.specification.class == 'AliasSpecification' || request.specification.class == 'AliasGroupSpecification' -%]
    [% IF request.reservationId %]
    <a class="btn" href="[% location %]/create?alias=[% request.reservationId %]">Request Room Capacity</a>
    [% ELSE %]
    <span class="btn disabled">Request Room Capacity</span>
    [% END %]
    [% END %]
    <a class="btn" href="">Refresh</a>
    <a class="btn" href="[% location %]/delete?id=[% request.id %]">Delete</a>
</div>